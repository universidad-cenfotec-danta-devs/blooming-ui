<div class="flex flex-col items-center text-center px-6 md:px-20 bg-[#dae5e4] pb-[10%]">
  <!-- Main Title -->
  <h1 class="text-8xl md:text-5xl font-semibold text-[#5C684B] mt-8">
    Dr. Plant
  </h1>

  <!-- Subtitle / Description -->
  <p class="text-[#5C684B] text-xl xl:text-3xl mt-4">
    Do you need help with your plants? Dr. Plant is here for you!
  </p>
  <p class="max-w-5xl text-xl xl:text-xl text-[#5C684B] mt-8">
    With our tool, you can identify your plants and receive personalized care recommendations.
    Simply upload a photo or enter the name of your plant, and we'll tell you everything you need to know:
    when to water it, how much light it needs, and more.
    You can also set reminders so you never forget to care for your plants.
  </p>

  <!-- Action Buttons and Upload Section -->
  <div class="flex justify-between items-start w-full max-w-4xl mt-8 relative justify-center">
    <!-- Left Image -->
    <div class="absolute left-0 top-70">
      <img src="../../../assets/images/dr-plant-1.png" alt="Left Plant" class="w-60 md:w-56">
    </div>

    <!-- Center Column with Buttons and Upload -->
    <div class="flex flex-col items-center justify-center">
      <!-- Action Buttons -->
      <div class="mt-6 flex space-x-2  justify-center">
        <button (click)="setSelectedAction('identify')" class="bg-[#DCE6D3] text-[#5C684B] px-4 py-2 rounded-md shadow-md transition">
          Identify Plant
        </button>
        <button (click)="setSelectedAction('diagnosis')" class="border border-[#DCE6D3] px-4 py-2 rounded-md shadow-md transition text-[#5C684B] secondary-btn">
          Plant Diagnosis
        </button>
        <button (click)="setSelectedAction('drplant')" class="border border-[#DCE6D3] px-4 py-2 rounded-md shadow-md transition bg-[#DCE6D3] text-[#5C684B]">
          Ask Dr. Plant
        </button>
      </div>

      <!-- Dynamic Hint Div -->
      <div class="mt-4">
        <div *ngIf="selectedAction === 'identify'">
          <p class="text-[#5C684B]">
            {{ uploadedImages['identify'] 
                ? 'Choose one of the 2 options to save that plant among your plants.' 
                : 'Upload a picture of the plant to identify it and get recommendations.' }}
          </p>
        </div>
        <div *ngIf="selectedAction === 'diagnosis'">
          <p class="text-[#5C684B]">
            {{ diseaseDataList.length > 0 
                ? 'Select the most probable disease for more details.' 
                : (uploadedImages['diagnosis'] 
                      ? 'Diagnose your plant to see suggested diseases.' 
                      : 'Upload an image of your plant for diagnosis.') }}
          </p>
        </div>
        <div *ngIf="selectedAction === 'drplant'">
          <p class="text-[#5C684B]">
            Chat with Dr. Plant to ask questions and receive more advice.
          </p>
        </div>
      </div>

      <!-- Upload Button (for Identify or Diagnosis) -->
      <div class="mt-6" *ngIf="selectedAction === 'identify' || selectedAction === 'diagnosis'">
        <label class="cursor-pointer primary-btn border rounded-md">
          {{ uploadedImages[selectedAction] ? 'Upload another image' : 'Upload Plant Image' }}
          <input type="file" (change)="onFileSelected($event)" class="hidden">
        </label>
        <div *ngIf="errorMessage" class="text-red-500 mt-2">
          {{ errorMessage }}
        </div>
      </div>
    </div>

    <!-- Right Image -->
    <div class="absolute right-0 top-70">
      <img src="../../../assets/images/dr-plant-2.png" alt="Right Plant" class="w-40 md:w-56">
    </div>
  </div>

  <!-- Loading Indicator -->
  <div *ngIf="isLoading" class="mt-6 text-gray-600">
    Processing...
  </div>

  <!-- Identify Mode: Display Plant Cards -->
  <div *ngIf="plantDataList.length > 0 && selectedAction === 'identify'" class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8 max-w-4xl bg-[#dae5e4]">
    <app-info-card
      *ngFor="let plant of plantDataList"
      [title]="plant.name"
      [description]="'Probability: ' + plant.probabilityPercentage + ', Similarity: ' + plant.similarityPercentage"
      [buttonLabel]="'Confirm'"
      [imageUrl]="plant.imageUrlSmall"
      [plantId]="plant.tokenPlant"
      (buttonClick)="confirmPlant(plant)"
    ></app-info-card>
  </div>

  <!-- Diagnosis Mode: Display Disease Cards using the Carousel -->
  <div *ngIf="diseaseDataList.length > 0 && selectedAction === 'diagnosis'" class="grid grid-cols-1 gap-6 mt-8 max-w-4xl bg-[#dae5e4]">
    <app-card-carousel 
      [items]="diseaseDataList" 
      (confirmDisease)="confirmDisease($event)">
    </app-card-carousel>
  </div>

  <!-- Chat Mode -->
  <app-dr-planta-chat
    id="drPlantaChat"
    class="w-full"
    [id]="chatPlantId"
    *ngIf="selectedAction === 'drplant'"
  ></app-dr-planta-chat>
</div>
