<div class="flex flex-col items-center w-full p-4">
  <!-- 3D Editor Section -->
  <div class="w-full max-w-6xl h-96 bg-white border border-gray-300 mb-6 relative">
    <div *ngIf="editorLoadError" class="absolute inset-0 flex items-center justify-center text-red-600 text-xl">
      {{ editorLoadError }}
    </div>
    <div *ngIf="loadingEditor" class="absolute inset-0 flex items-center justify-center">
      Loading 3D editor...
    </div>
    <canvas #editorCanvas class="w-full h-full" *ngIf="!loadingEditor && !editorLoadError"></canvas>
  </div>

  <!-- File Upload Button -->
  <div class="mb-6 flex items-center space-x-4">
    <input type="file" #fileInput (change)="onFileSelected($event)" accept=".glb" class="hidden">
    <button (click)="fileInput.click()" class="px-4 py-2 bg-indigo-500 text-white rounded">
      Upload Model
    </button>
    <!-- Dropdown to select a model from the list -->
    <select [(ngModel)]="selectedModel" class="p-2 border border-gray-300 rounded">
      <option *ngFor="let model of modelList" [value]="model">{{ model }}</option>
    </select>
    <button (click)="loadSelectedModel()" class="px-4 py-2 bg-blue-500 text-white rounded">
      Load Selected Model
    </button>
  </div>

  <!-- Steps Indicator -->
  <div class="flex space-x-4 mb-4">
    <ng-container *ngFor="let step of steps; let i = index">
      <div class="flex items-center justify-center w-10 h-10 rounded-full border-2"
           [class.bg-blue-500]="i <= currentStepIndex"
           [class.text-white]="i <= currentStepIndex"
           [class.border-gray-300]="i > currentStepIndex">
        {{ i + 1 }}
      </div>
      <div *ngIf="i < steps.length - 1" class="w-8 h-1 bg-gray-300 self-center"></div>
    </ng-container>
  </div>

  <!-- Current Step Title -->
  <h2 class="text-xl font-semibold mb-4">
    Step {{ currentStepIndex + 1 }}: {{ currentStep }}
  </h2>

  <!-- Wizard Form -->
  <form [formGroup]="potForm" class="w-full max-w-xl space-y-4">
    <!-- Step 1: Material -->
    <div *ngIf="currentStepIndex === 0" class="flex flex-col space-y-2">
      <label class="font-medium">Material</label>
      <select formControlName="material" class="p-2 border border-gray-300 rounded">
        <option value="" disabled>-- Select Material --</option>
        <option value="Ceramic">Ceramic</option>
        <option value="Plastic">Plastic</option>
        <option value="Metal">Metal</option>
        <option value="Wood">Wood</option>
      </select>
    </div>

    <!-- Step 2: Size -->
    <div *ngIf="currentStepIndex === 1" class="flex flex-col space-y-2">
      <label class="font-medium">Size (e.g., diameter)</label>
      <input type="number" formControlName="size" class="p-2 border border-gray-300 rounded" placeholder="10" />
    </div>

    <!-- Step 3: Color -->
    <div *ngIf="currentStepIndex === 2" class="flex flex-col space-y-2">
      <label class="font-medium">Color</label>
      <select formControlName="color" class="p-2 border border-gray-300 rounded">
        <option value="" disabled>-- Select Color --</option>
        <option value="red">Red</option>
        <option value="blue">Blue</option>
        <option value="#008000">Green</option>
        <option value="#a52a2a">Brown</option>
        <option value="#808080">Gray</option>
      </select>
    </div>

    <!-- Step 4: Forma -->
    <div *ngIf="currentStepIndex === 3" class="flex flex-col space-y-2">
      <label class="font-medium">Forma (Shape)</label>
      <select formControlName="forma" class="p-2 border border-gray-300 rounded">
        <option value="" disabled>-- Select Shape --</option>
        <option value="Circular">Circular</option>
        <option value="Square">Square</option>
      </select>
    </div>
  </form>

  <!-- Navigation Buttons -->
  <div class="flex items-center space-x-4 mt-6">
    <button (click)="prevStep()" [disabled]="currentStepIndex === 0"
            class="px-4 py-2 bg-gray-200 text-gray-600 rounded disabled:opacity-50">
      Previous
    </button>
    <button (click)="nextStep()" [disabled]="currentStepIndex === steps.length - 1"
            class="px-4 py-2 bg-blue-500 text-white rounded disabled:opacity-50">
      Next
    </button>
  </div>

  <!-- Price Calculation & Submission -->
  <div class="flex flex-col items-center mt-8 space-y-4">
    <button (click)="calculatePrice()"
            class="px-6 py-2 bg-green-500 text-white rounded">
      Calculate Price
    </button>
    <div *ngIf="price" class="text-lg font-semibold">
      Price: {{ price | currency }}
    </div>
    <button (click)="onSubmit()"
            class="px-6 py-2 bg-purple-500 text-white rounded">
      Confirm Creation
    </button>
  </div>
</div>
